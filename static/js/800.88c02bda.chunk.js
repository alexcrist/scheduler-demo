!function(){"use strict";var e={800:function(e,t,r){var n=r(165),a=r(861),f=r(683),o="ALL_DAYS",s="NUM_CALCULATIONS",i="RESULT",u=r(426),c=r.n(u),l=function(e,t){for(var r=[],n=c()(e),a=c()(t);n<=a;)r.push(n.format("YYYY-MM-DD")),n.add(1,"day");return r},d={},h=function(e,t){var r="".concat(e," - ").concat(t);if(!(r in d)){var n=c()(e).diff(c()(t),"days");d[r]=n}return d[r]},v=function(e,t){return function(r){var n=r.type,a=r.numStaff;if(n===o)return l(e,t).map((function(e){return{date:e,numStaff:a}}))}},p=function(e){return e[0]},y=r(671),D=r(144),O=r(763),m=r.n(O),g=function(){function e(){(0,y.Z)(this,e),this.lastMoveDescription="",this.jobs=[],this.staff=[],this.staffBreaks=[],this.numDaysOfCamp=0,this.dayBeforeFirstDay=null,this.dayAfterLastDay=null,this.dateToIndexMap={},this.jobIdMap={},this.personIdMap={},this.personToDaysOffMap={},this.numQualifiedOnDutyMap={}}return(0,D.Z)(e,[{key:"initEmptySchedule",value:function(e,t,r,n){var a=this;this.jobs=r,this.staff=n,this.numDaysOfCamp=c()(t).diff(c()(e),"days")+1,this.dayBeforeFirstDay=c()(e).subtract(1,"day").format("YYYY-MM-DD"),this.dayAfterLastDay=c()(t).add(1,"day").format("YYYY-MM-DD"),this.staffBreaks=l(e,t).map((function(e){return{date:e,staffOnBreak:[]}})),this.staffBreaks.forEach((function(e,t){a.dateToIndexMap[e.date]=t})),this.jobs.forEach((function(e){a.jobIdMap[e.id]=e,a.numQualifiedOnDutyMap[e.id]={},e.dateRequirements.forEach((function(t){a.numQualifiedOnDutyMap[e.id][t.date]=0}))})),this.staff.forEach((function(e){a.personIdMap[e.id]=e,a.personToDaysOffMap[e.id]=[],e.jobs.forEach((function(e){Object.keys(a.numQualifiedOnDutyMap[e]).forEach((function(t){a.numQualifiedOnDutyMap[e][t]+=1}))}))}))}},{key:"clone",value:function(){var t=new e;return t.jobs=this.jobs,t.staff=this.staff,t.numDaysOfCamp=this.numDaysOfCamp,t.dayBeforeFirstDay=this.dayBeforeFirstDay,t.dayAfterLastDay=this.dayAfterLastDay,t.staffBreaks=m().cloneDeep(this.staffBreaks),t.dateToIndexMap=this.dateToIndexMap,t.jobIdMap=this.jobIdMap,t.personIdMap=this.personIdMap,t.personToDaysOffMap=m().cloneDeep(this.personToDaysOffMap),t.numQualifiedOnDutyMap=m().cloneDeep(this.numQualifiedOnDutyMap),t}},{key:"getDay",value:function(e){var t=this.dateToIndexMap[e];return this.staffBreaks[t]}},{key:"getPerson",value:function(e){return this.personIdMap[e]}},{key:"getDaysOff",value:function(e){return this.personToDaysOffMap[e]}},{key:"getNumQualifiedOnDutyStaff",value:function(e,t){return this.numQualifiedOnDutyMap[e][t]}},{key:"addDayOff",value:function(e,t){var r=this;this.personToDaysOffMap[e].push(t),this.personToDaysOffMap[e].sort();var n=this.dateToIndexMap[t];this.staffBreaks[n].staffOnBreak.push(e),this.getPerson(e).jobs.forEach((function(e){t in r.numQualifiedOnDutyMap[e]&&(r.numQualifiedOnDutyMap[e][t]-=1)}))}},{key:"removeDayOff",value:function(e,t){var r=this;m().remove(this.personToDaysOffMap[e],(function(e){return e===t}));var n=this.dateToIndexMap[t];m().remove(this.staffBreaks[n].staffOnBreak,(function(t){return t===e})),this.getPerson(e).jobs.forEach((function(e){t in r.numQualifiedOnDutyMap[e]&&(r.numQualifiedOnDutyMap[e][t]+=1)}))}},{key:"moveDayOff",value:function(e,t,r){this.lastMoveDescription="Moving ".concat(this.personIdMap[e].name," from ").concat(t," to ").concat(r),this.removeDayOff(e,t),this.addDayOff(e,r)}}]),e}(),M=r(785),k=function(e,t){for(var r=(t.numDaysOfCamp-e.allottedDaysOff)/(e.allottedDaysOff+1),n=0,a=[t.dayBeforeFirstDay].concat((0,M.Z)(t.getDaysOff(e.id)),[t.dayAfterLastDay]),f=0;f<a.length-1;f++){var o=a[f],s=a[f+1];n+=Math.pow(h(s,o),2)}return Math.sqrt(Math.pow(r,2)*(a.length-1))/(n=Math.sqrt(n))*100},b=function(e,t){if(0===e.requestedDaysOff.length)return 100;var r=t.getDaysOff(e.id);return 100*T(r,[e.requestedDaysOff])/e.requestedDaysOff.length},S=function(e,t){if(0===e.friends.length)return 100;var r=e.friends.length*e.allottedDaysOff;return 100*I(e,e.friends,t)/r},B=function(e,t){if(!e.bestFriend)return 100;var r=e.allottedDaysOff;return 100*I(e,[e.bestFriend],t)/r},j=function(e,t){if(!e.enemy)return 100;var r=e.allottedDaysOff;return 100-100*I(e,[e.enemy],t)/r},I=function(e,t,r){for(var n=r.getDaysOff(e.id),a=[],f=0;f<t.length;f++)a.push(r.getDaysOff(t[f]));return T(n,a)},T=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(0);for(var a=0,f=0;f<e.length;f++)for(var o=e[f],s=0;s<t.length;s++){var i=t[s];if(0!==i.length){for(var u=i[r[s]];r[s]<i.length-1&&u<o;)r[s]++,u=i[r[s]];u===o&&a++}}return a},x=0,w=function(){return x},q=function(e){x++;var t=function(e){for(var t=[],r=0;r<e.staff.length;r++){var n=e.staff[r],a=1*k(n,e);a+=1*S(n,e),a+=5*B(n,e),a+=5*j(n,e),a+=5*b(n,e),a/=17,t.push(a)}return t}(e),r=t.reduce((function(e,t){return e+t}),0)/t.length,n=1*t.reduce((function(e,t){return Math.min(e,t)}),t[0])+1*r;n/=2;var a=function(e){for(var t=0,r=0;r<e.jobs.length;r++)for(var n=e.jobs[r],a=0;a<n.dateRequirements.length;a++){var f=n.dateRequirements[a],o=f.date,s=f.numStaff,i=e.getNumQualifiedOnDutyStaff(n.id,o);t+=i>=s?100/e.jobs.length/n.dateRequirements.length:100/e.jobs.length/n.dateRequirements.length*(i/s)}return t}(e),f=99999*a+1*n;return{peopleScores:t,campScore:a,overallScore:f/=1e5}};self.onmessage=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,f,o,s,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.data,a=r.startDate,f=r.endDate,o=r.jobs,s=r.staff,u=Y(a,f,o,s),self.postMessage({type:i,payload:u});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Q=function(e){self.postMessage({type:s,payload:e})},Y=function(e,t,r,n){x=0;var a=function(e,t,r){for(var n=[],a=0;a<r.length;a++)n.push((0,f.Z)({},r[a])),n[a].dateRequirements=r[a].staffRequirements.map(v(e,t)),n[a].dateRequirements=p(n[a].dateRequirements);return n}(e,t,r),o=function(e){return e.map((function(e){return(0,f.Z)((0,f.Z)({},e),{},{allottedDaysOff:4})}))}(n),s=new g;s.initEmptySchedule(e,t,a,o),s=E(s),s=C(s);var i=q(s);return i.detailedPeopleScores=function(e){for(var t={},r=0;r<e.staff.length;r++){var n=e.staff[r];t[n.id]={},t[n.id].clumpiness=k(n,e),t[n.id].requestedDaysOff=b(n,e),t[n.id].bestFriend=B(n,e),t[n.id].enemy=j(n,e),t[n.id].friends=S(n,e)}return t}(s),console.log(s.staff,s.personToDaysOffMap),{schedule:s,scores:i}},E=function(e){for(var t=e.staff.reduce((function(e,t){return e+t.allottedDaysOff}),0),r=0,n=q(e);r<t;){Q(w());for(var a=F(n),f=void 0,o=0;o<a.length;o++){var s=a[o];if(f=e.staff[s],e.getDaysOff(f.id).length<f.allottedDaysOff)break}var i=L(e,f);e=i.schedule,n=i.scores,r++}return e},C=function(e){for(var t=q(e);;){Q(w());var r=R(e,t),n=r.isBetter,a=r.newSchedule,f=r.newScores;if(!n)return e;e=a,t=f,console.log(e.lastMoveDescription)}},F=function(e){for(var t=[],r=0;r<e.peopleScores.length;r++)t.push({score:e.peopleScores[r],personIndex:r});t=m().sortBy(t,(function(e){return e.score}));for(var n=[],a=0;a<t.length;a++)n.push(t[a].personIndex);return n},L=function(e,t){var r={overallScore:-1},n=null,a=e.getDaysOff(t.id);if(a.length<t.allottedDaysOff)for(var f=0;f<e.staffBreaks.length;f++){var o=e.staffBreaks[f];if(!a.includes(o.date)){var s=e.clone();s.addDayOff(t.id,o.date);var i=q(s);i.overallScore>r.overallScore&&(r=i,n=s)}}return{scores:r,schedule:n}},R=function(e,t){for(var r=F(t),n=[A,Z,P],a=0;a<r.length;a++)for(var f=r[a],o=e.staff[f],s=0;s<n.length;s++){var i=(0,n[s])(e,o);if(i.scores.overallScore>t.overallScore)return{isBetter:!0,newSchedule:i.schedule,newScores:i.scores}}return{isBetter:!1}},A=function(e,t){for(var r={overallScore:-1},n=null,a=e.getDaysOff(t.id),f=0;f<a.length;f++)for(var o=a[f],s=0;s<e.staffBreaks.length;s++){var i=e.staffBreaks[s].date;if(o!==i&&!a.includes(i)){var u=e.clone();u.moveDayOff(t.id,o,i);var c=q(u);c.overallScore>r.overallScore&&(r=c,n=u)}}return{scores:r,schedule:n}},Z=function(e,t){for(var r={overallScore:-1},n=null,a=e.getDaysOff(t.id),f=0;f<a.length;f++)for(var o=a[f],s=0;s<e.staff.length;s++){var i=e.staff[s];if(t.id!==i.id)for(var u=e.getDaysOff(i.id),c=0;c<u.length;c++){var l=u[c];if(o!==l&&!a.includes(l)&&!u.includes(o)){var d=e.clone();d.moveDayOff(t.id,o,l),d.moveDayOff(i.id,l,o);var h=q(d);h.overallScore>r.overallScore&&(r=h,n=d)}}}return{scores:r,schedule:n}},P=function(e,t){for(var r={overallScore:-1},n=null,a=e.getDaysOff(t.id),f=0;f<a.length;f++)for(var o=a[f],s=e.getDay(o),i=0;i<e.staffBreaks.length;i++){var u=e.staffBreaks[i];if(s.date!==u.date){for(var c=e.clone(),l=0;l<s.staffOnBreak.length;l++){var d=s.staffOnBreak[l];c.moveDayOff(d,s.date,u.date)}for(var h=0;h<u.staffOnBreak.length;h++){var v=u.staffOnBreak[h];c.moveDayOff(v,u.date,s.date)}var p=q(c);p.overallScore>r.overallScore&&(r=p,n=c)}}return{scores:r,schedule:n}}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var f=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(f.exports,f,f.exports,r),f.loaded=!0,f.exports}r.m=e,r.x=function(){var e=r.O(void 0,[94],(function(){return r(800)}));return e=r.O(e)},function(){var e=[];r.O=function(t,n,a,f){if(!n){var o=1/0;for(c=0;c<e.length;c++){n=e[c][0],a=e[c][1],f=e[c][2];for(var s=!0,i=0;i<n.length;i++)(!1&f||o>=f)&&Object.keys(r.O).every((function(e){return r.O[e](n[i])}))?n.splice(i--,1):(s=!1,f<o&&(o=f));if(s){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}f=f||0;for(var c=e.length;c>0&&e[c-1][2]>f;c--)e[c]=e[c-1];e[c]=[n,a,f]}}(),r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))},r.u=function(e){return"static/js/"+e+".f84c3752.chunk.js"},r.miniCssF=function(e){},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},r.p="/scheduler-demo/",function(){var e={800:1};r.f.i=function(t,n){e[t]||importScripts(r.p+r.u(t))};var t=self.webpackChunkcamp_react=self.webpackChunkcamp_react||[],n=t.push.bind(t);t.push=function(t){var a=t[0],f=t[1],o=t[2];for(var s in f)r.o(f,s)&&(r.m[s]=f[s]);for(o&&o(r);a.length;)e[a.pop()]=1;n(t)}}(),function(){var e=r.x;r.x=function(){return r.e(94).then(e)}}();r.x()}();
//# sourceMappingURL=800.88c02bda.chunk.js.map